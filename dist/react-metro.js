"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var React=_interopDefault(require("react")),gsap=require("gsap"),classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},possibleConstructorReturn=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},toConsumableArray=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},MetroHoc=function(e){var t,n;return n=t=function(t){function n(){return classCallCheck(this,n),possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return inherits(n,t),createClass(n,[{key:"getLongestAnimationInSequence",value:function(e){return Math.max.apply(Math,toConsumableArray(this.props.sequence.map(function(t){return t.animation[e].time+t.animation[e].delay})))}},{key:"isThisTheLongestAnimation",value:function(e,t){var n=this.getLongestAnimationInSequence(t);return e[t].time+e[t].delay>=n}},{key:"applySequenceEndIfLastInSequence",value:function(e,t,n){var i=this.getLongestAnimationInSequence(n),o=!0;return t.forEach(function(t,a){t.animation[n].time+t.animation[n].delay===i&&a>e&&(o=!1)}),o}},{key:"componentWillEnter",value:function(e){var t=this,n=this.container;this.props.sequence[this.props.itemIndex].animating=!0,gsap.TweenMax.fromTo(n,this.props.animation.in.time,this.props.animation.willEnter.from,_extends({},this.props.animation.willEnter.to,{delay:this.props.animation.in.delay,onComplete:function(){t.isThisTheLongestAnimation(t.props.animation,"in")&&t.applySequenceEndIfLastInSequence(t.props.index,t.props.sequence,"in")&&t.props.onMount&&t.props.onMount(),t.props.sequence[t.props.itemIndex].animating=!1,e()}}))}},{key:"componentWillLeave",value:function(e){var t=this,n=this.container,i=this.getLongestAnimationInSequence("out")-(this.props.animation.out.time+this.props.animation.out.delay);this.props.sequence[this.props.itemIndex].animating=!0,gsap.TweenMax.fromTo(n,this.props.animation.out.time,this.props.animation.willLeave.from,_extends({},this.props.animation.willLeave.to,{delay:this.props.animation.out.delay,onComplete:function(){setTimeout(function(){t.isThisTheLongestAnimation(t.props.animation,"out")&&t.applySequenceEndIfLastInSequence(t.props.index,t.props.sequence,"out")&&t.props.onUnmount&&t.props.onUnmount(),t.props.sequence[t.props.itemIndex].animating=!1,e()},1e3*i)}}))}},{key:"render",value:function(){var t=this;return React.createElement(this.props.wrapperType,{ref:function(e){return t.container=e}},React.createElement(e,this.props))}}]),n}(React.Component),t.defaultProps={wrapperType:"div"},n},delayedVerticalPreset=function(e,t,n,i,o){for(var a=[],r={willEnter:{from:{opacity:0,y:50},to:{opacity:1,y:0}}},s={willLeave:{from:{opacity:1,y:0},to:{opacity:0,y:50}}},l=0;l<n;l++)a.push(_extends({in:{time:i,delay:l*o},out:{time:i,delay:l*o}},s,r));return t&&a.splice(t,0,_extends({in:{time:i,delay:0},out:{time:i,delay:0}},s,r)),a},dominoPreset=function(e,t,n,i,o){var a=t||0,r=[],s=0,l=1,u={willLeave:{from:{opacity:1,skewX:"0deg",y:0},to:{opacity:0,skewX:"-10deg",y:20}}},p={willEnter:{from:{opacity:0,skewX:"-10deg",y:20},to:{opacity:1,skewX:"0deg",y:0}}};if("multi"===e){for(var c=a,m=a;m>0;m--)r.push(_extends({in:{time:2*i,delay:o*c*2},out:{time:2*i,delay:o*c*2}},u,p)),c-=1;for(var d=a+1;d<n;d++)r.push(_extends({in:{time:2*i,delay:o*s*2},out:{time:2*i,delay:o*s*2}},u,p)),s+=1}else if("backwards"===e){for(var f=a,y=a;y>0;y--)r.push(_extends({in:{time:i,delay:o*f},out:{time:i,delay:o*f}},u,p)),f-=1;for(var h=n-1,v=n;v>a;v--)r.push(_extends({in:{time:i,delay:o*h},out:{time:i,delay:o*h}},u,p)),h-=1}else for(var w=0;w<n;w++)if(w<a){var g=w*o+(n-a)*o;r.push(_extends({in:{time:i,delay:g},out:{time:i,delay:g}},u,p))}else w>a&&(r.push(_extends({in:{time:i,delay:o*l},out:{time:i,delay:o*l}},u,p)),l+=1);return r.splice(a,0,_extends({in:{time:i,delay:0},out:{time:i,delay:0}},u,p)),r},animations={domino:dominoPreset,delayedVertical:delayedVerticalPreset},defaultAnimation={animation:{out:{time:.4,delay:0},in:{time:.4,delay:0},willEnter:{from:{opacity:0},to:{opacity:1,ease:"easeInOut"}},willLeave:{from:{opacity:1},to:{opacity:0}}}},metroContainer=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=_extends({},t||defaultAnimation),o=_extends({},i,{key:0,itemIndex:0,sequence:[_extends({},i)]});return React.createElement(Metro.animation,_extends({},o,n),e)},combineAnimations=function(e,t){return t?{out:_extends({},e.out,t.out),in:_extends({},e.in,t.in),willEnter:{from:_extends({},e.willEnter&&e.willEnter.from,t.willEnter&&t.willEnter.from),to:_extends({},e.willEnter&&e.willEnter.to,t.willEnter&&t.willEnter.to)},willLeave:{from:_extends({},e.willLeave&&e.willLeave.from,t.willLeave&&t.willLeave.from),to:_extends({},e.willLeave&&e.willLeave.to,t.willLeave&&t.willLeave.to)}}:e},metroSequence=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i={animation:n?combineAnimations(defaultAnimation.animation,n.animation):defaultAnimation.animation},o=e.map(function(e,n){var o=combineAnimations(i.animation,t[n]),a=_extends({},i,{animation:o});return _extends({},a,{content:e})});return o.map(function(e,t){return _extends({key:t,itemIndex:t},e,{sequence:o})})},metroAnimation=MetroHoc(function(e){function t(){return classCallCheck(this,t),possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return inherits(t,e),createClass(t,[{key:"render",value:function(){var e=this;return React.createElement("div",{onClick:function(){var t=e.props.sequence.some(function(e){return e.animating});!e.props.onClick||t&&!e.props.enableClickDuringAnimation||e.props.onClick(e.props.content,e.props.itemIndex,t)}},this.props.children)}}]),t}(React.Component)),generateFocusAnimationMap=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1],n=arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"dominoForwards",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=(Math.ceil(n/t),.75*o/n),r=[e,n,a,a+.25*o/n];if(i.includes("domino")){var s=i.split("domino")[1].toLowerCase();return animations.domino.apply(animations,[s].concat(r))}if(i.includes("delayed")){var l=i.split("delayed")[1].toLowerCase();return animations.delayedVertical.apply(animations,[l].concat(r))}return[]},Metro={sequence:metroSequence,animation:metroAnimation,container:metroContainer,generateFocusMap:generateFocusAnimationMap};exports.default=Metro;
